<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YCT1 Ë∂£Âë≥Âê¨ÂäõÁªÉ‰π†</title>
    <style>
        body {
            background-color: #f5f5dc;
            font-family: KaiTi, serif;
            text-align: center;
            padding: 20px;
        }
        .main-title {
            font-size: 48px;
            margin: 30px 0;
        }
        .title-pinyin {
            font-family: "Comic Sans MS", cursive;
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            max-width: 800px;
            margin: 40px auto;
        }
        .lesson-btn {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            font-size: 24px;
        }
        .lesson-btn:hover {
            transform: scale(1.05) rotate(2deg);
        }
        #practicePanel {
            position: relative;
        }
        #backBtn {
            position: absolute;
            left: 20px;
            top: 20px;
            padding: 12px 24px;
            border-radius: 20px;
            background: #FFB6C1;
            border: 2px solid white;
            font-size: 18px;
            color: #8B0000;
            cursor: pointer;
            transition: all 0.3s;
        }
        #backBtn:hover {
            background: #FF69B4;
            transform: scale(1.1);
        }
        .options {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        .option {
            background: linear-gradient(145deg, #87CEEB, #4682B4);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            width: 200px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .option:hover {
            transform: scale(1.05);
        }
        .pinyin {
            font-family: "Comic Sans MS", cursive;
            font-size: 28px;
            margin-bottom: 10px;
            color: #FFD700;
        }
        .chinese {
            font-size: 24px;
        }
        #nextBtn {
            font-size: 24px;
            padding: 15px 30px;
            margin: 20px;
            border-radius: 25px;
            background: linear-gradient(145deg, #FFA07A, #FF6347);
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        #nextBtn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        .congrats {
            font-size: 48px;
            color: #4CAF50;
            margin: 40px 0;
        }
        .score {
            font-size: 36px;
            color: #2c3e50;
            margin: 20px 0;
        }
        .timer {
            font-size: 32px;
            margin: 20px 0;
            color: #2c3e50;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }
        .error-shake {
            animation: shake 0.4s ease-in-out;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-title">
        <div class="title-pinyin">Tƒ´ng L√¨ Li√†n X√≠</div>
        Âê¨ÂäõÁªÉ‰π†
    </div>
    <div class="lesson-grid" id="lessonGrid"></div>

    <div id="practicePanel" style="display:none;">
        <button id="backBtn">üêæ ËøîÂõûËØæÁ®ã</button>
        <div class="timer" id="timer">10</div>
        <div class="options" id="options"></div>
        <div id="result"></div>
        <button id="nextBtn" disabled>üéâ ‰∏ã‰∏ÄÈ¢ò</button>
    </div>

<script>
// ================== ÂèØ‰øÆÊîπÁöÑÊãºÈü≥ÈÖçÁΩÆ ==================
const pinyinMap = {
    "‰∏Ä":"yƒ´", "‰∫å":"√®r", "‰∏â":"sƒÅn", "Âõõ":"s√¨", "‰∫î":"w«î",
    "ÂÖ≠":"li√π", "‰∏É":"qƒ´", "ÂÖ´":"bƒÅ", "‰πù":"ji«î", "ÂçÅ":"sh√≠",
    "ËÄÅÂ∏à":"l«éo shƒ´", "‰Ω†":"n«ê", "Â•Ω":"h«éo", "ÂÜçËßÅ":"z√†i ji√†n",
    "Êàë":"w«í", "Âè´":"ji√†o", "‰ªÄ‰πà":"sh√©n me", "ËÆ§ËØÜ":"r√®n shi",
    "Âæà":"hƒõn", "È´òÂÖ¥":"gƒÅo x√¨ng", "Â•π":"tƒÅ", "Âêó":"ma", "‰∏ç":"b√π",
    "‰ªñ":"tƒÅ", "ÊòØ":"sh√¨", "Ë∞Å":"sh√©i", "Âì™":"n«é", "ÂõΩ":"gu√≥",
    "‰∫∫":"r√©n", "‰∏≠ÂõΩ‰∫∫":"zh≈çng gu√≥ r√©n", "Áà∏Áà∏":"b√† ba", "Â¶àÂ¶à":"mƒÅ ma",
    "Âì•Âì•":"gƒì ge", "ÂßêÂßê":"jiƒõ jie", "ÂºüÂºü":"d√¨ di", "Â¶πÂ¶π":"m√®i mei",
    "ÂÆ∂":"jiƒÅ", "Êúâ":"y«íu", "Âá†":"j«ê", "Âè£":"k«íu", "Âíå":"h√©",
    "Ê≤°Êúâ":"m√©i y«íu", "‰∏™":"g√®", "Â≤Å":"su√¨", "Â§öÂ§ß":"du≈ç d√†",
    "‰πü":"yƒõ", "Â§¥Âèë":"t√≥u fa", "ÈºªÂ≠ê":"b√≠ zi", "ÁúºÁùõ":"y«én jing",
    "ËÄ≥Êúµ":"ƒõr duo", "Êâã":"sh«íu", "ÁöÑ":"de", "Â∞è":"xi«éo", "Â§ß":"d√†",
    "Èïø":"ch√°ng", "‰∏™Â≠ê":"g√® zi", "Áúü":"zhƒìn", "È´ò":"gƒÅo", "Áå´":"mƒÅo",
    "Áãó":"g«íu", "È±º":"y√∫", "È∏ü":"ni«éo", "Ëøô":"zh√®", "ÈÇ£":"n√†",
    "Áúã":"k√†n", "ËøôÂÑø":"zh√®r", "Â§ö":"du≈ç", "ÈÇ£ÂÑø":"n√†r", "Â≠¶Ê†°":"xu√© xi√†o",
    "ÂïÜÂ∫ó":"shƒÅng di√†n", "Âú®":"z√†i", "Ë∞¢Ë∞¢":"xi√® xie", "Âéª":"q√π",
    "‰Ω†‰ª¨":"n«ê men", "Êàë‰ª¨":"w«í men", "Âì™ÂÑø":"n«ér", "ÁîüÊó•":"shƒìng r√¨",
    "Êúà":"yu√®", "Âè∑":"h√†o", "‰ªäÂ§©":"jƒ´n tiƒÅn", "ÊòéÂ§©":"m√≠ng tiƒÅn",
    "ÊòüÊúü":"xƒ´ng qƒ´", "ÂñúÊ¨¢":"x«ê huan", "ÊòüÊúü‰∏Ä":"xƒ´ng qƒ´ yƒ´",
    "ÊòüÊúü‰∫å":"xƒ´ng qƒ´ √®r", "ÊòüÊúü‰∏â":"xƒ´ng qƒ´ sƒÅn", "ÊòüÊúüÂõõ":"xƒ´ng qƒ´ s√¨",
    "ÊòüÊúü‰∫î":"xƒ´ng qƒ´ w«î", "ÊòüÊúüÂÖ≠":"xƒ´ng qƒ´ li√π", "ÊòüÊúüÂ§©":"xƒ´ng qƒ´ tiƒÅn",
    "Áé∞Âú®":"xi√†n z√†i", "ÁÇπ":"di«én", "ÂàÜ":"fƒìn", "ËßÅ":"ji√†n",
    "Êó©‰∏ä":"z«éo shang", "Â§™Êó©‰∫Ü":"t√†i z«éo le", "ÂêÉ":"chƒ´", "Âñù":"hƒì",
    "Áà±":"√†i", "ËõãÁ≥ï":"d√†n gƒÅo", "Á±≥È•≠":"m«ê f√†n", "Èù¢Êù°":"mi√†n ti√°o",
    "ËãπÊûú":"p√≠ng gu«í", "ÁâõÂ•∂":"ni√∫ n«éi", "Ê∞¥":"shu«ê"
};

// ================== ËØæÁ®ãÊï∞ÊçÆ ==================
const lessonData = {
    "1": ["‰∏Ä", "‰∫å", "‰∏â", "Âõõ", "‰∫î", "ÂÖ≠", "‰∏É", "ÂÖ´", "‰πù", "ÂçÅ", "ËÄÅÂ∏à", "‰Ω†", "Â•Ω", "ÂÜçËßÅ"],
    "2": ["Êàë", "Âè´", "‰ªÄ‰πà", "ËÆ§ËØÜ", "Âæà", "È´òÂÖ¥", "Â•π", "Âêó", "‰∏ç"],
    "3": ["‰ªñ", "ÊòØ", "Ë∞Å", "Âì™", "ÂõΩ", "‰∫∫", "‰∏≠ÂõΩ‰∫∫"],
    "4": ["Áà∏Áà∏", "Â¶àÂ¶à", "Âì•Âì•", "ÂßêÂßê", "ÂºüÂºü", "Â¶πÂ¶π", "ÂÆ∂", "Êúâ", "Âá†", "Âè£", "Âíå", "Ê≤°Êúâ", "‰∏™"],
    "5": ["Â≤Å", "Â§öÂ§ß", "‰πü", "Áà∏Áà∏", "Â¶àÂ¶à", "Âì•Âì•", "ÂßêÂßê", "ÂºüÂºü", "Â¶πÂ¶π"],
    "6": ["Â§¥Âèë", "ÈºªÂ≠ê", "ÁúºÁùõ", "ËÄ≥Êúµ", "Êâã", "ÁöÑ", "Â∞è", "Â§ß", "Èïø", "‰∏™Â≠ê", "Áúü", "È´ò"],
    "7": ["Áå´", "Áãó", "È±º", "È∏ü", "Ëøô", "ÈÇ£", "Áúã", "ËøôÂÑø", "Â§ö", "ÈÇ£ÂÑø"],
    "8": ["Â≠¶Ê†°", "ÂïÜÂ∫ó", "Âú®", "Ë∞¢Ë∞¢", "Âéª", "‰Ω†‰ª¨", "Êàë‰ª¨", "Âì™ÂÑø"],
    "9": ["ÁîüÊó•", "Êúà", "Âè∑", "‰ªäÂ§©", "ÊòéÂ§©", "ÊòüÊúü", "ÂñúÊ¨¢", "ÊòüÊúü‰∏Ä", "ÊòüÊúü‰∫å", "ÊòüÊúü‰∏â", "ÊòüÊúüÂõõ", "ÊòüÊúü‰∫î", "ÊòüÊúüÂÖ≠", "ÊòüÊúüÂ§©"],
    "10": ["Áé∞Âú®", "ÁÇπ", "ÂàÜ", "ËßÅ", "Êó©‰∏ä", "Â§™Êó©‰∫Ü"],
    "11": ["ÂêÉ", "Âñù", "Áà±", "ËõãÁ≥ï", "Á±≥È•≠", "Èù¢Êù°", "ËãπÊûú", "ÁâõÂ•∂", "Ê∞¥"],
    "12": []
};

// ================== Á≥ªÁªüÊ†∏ÂøÉÈÄªËæë ==================
let currentLesson = "";
let currentWords = [];
let currentIndex = 0;
let timer;
let synth = window.speechSynthesis;
let chineseVoice;

function initVoices() {
    const voices = synth.getVoices();
    chineseVoice = voices.find(voice => 
        voice.lang === 'zh-CN' && voice.name.includes('Xiaoxiao')
    ) || voices.find(voice => 
        voice.lang.startsWith('zh')
    );
}

function initLessons() {
    const grid = document.getElementById("lessonGrid");
    grid.innerHTML = Array.from({length:12}, (_,i) => {
        const lessonNumber = i + 1;
        return `<div class="lesson-btn" onclick="startPractice('${lessonNumber}')">Lesson${lessonNumber}</div>`;
    }).join("");
}

function startPractice(lessonId) {
    currentLesson = lessonId;
    currentIndex = 0;
    
    if (lessonId === "12") {
        const allWords = [];
        for (let i = 1; i <= 11; i++) {
            allWords.push(...lessonData[i.toString()]);
        }
        currentWords = shuffleArray(allWords).slice(0, 10);
    } else {
        currentWords = [...lessonData[lessonId]];
    }

    currentWords = currentWords.map(word => ({
        word: word,
        pinyin: pinyinMap[word] || word,
        correct: false,
        answered: false
    }));

    document.getElementById("lessonGrid").style.display = "none";
    document.getElementById("practicePanel").style.display = "block";
    showQuestion();
}

function showQuestion() {
    const wordObj = currentWords[currentIndex];
    const options = generateOptions(wordObj);
    
    document.getElementById("options").innerHTML = options.map(w => `
        <div class="option" onclick="checkAnswer('${w.word}', '${wordObj.word}')">
            <div class="pinyin">${w.pinyin}</div>
            <div class="chinese">${w.word}</div>
        </div>
    `).join("");

    playAudio(wordObj.word);
    startTimer();
}

function playAudio(word) {
    if (synth.speaking) synth.cancel();
    
    const utterance = new SpeechSynthesisUtterance(word);
    utterance.lang = 'zh-CN';
    utterance.rate = 0.8;
    utterance.pitch = 1;
    if (chineseVoice) utterance.voice = chineseVoice;

    synth.speak(utterance);
    setTimeout(() => {
        const utterance2 = new SpeechSynthesisUtterance(word);
        utterance2.lang = 'zh-CN';
        utterance2.rate = 0.8;
        utterance2.pitch = 1;
        if (chineseVoice) utterance2.voice = chineseVoice;
        synth.speak(utterance2);
    }, 800);
}

function startTimer() {
    let time = 10;
    const timerElement = document.getElementById("timer");
    clearInterval(timer);
    timer = setInterval(() => {
        time--;
        timerElement.textContent = time;
        if (time <= 0) handleTimeout();
    }, 1000);
}

function checkAnswer(selected, correct) {
    const wordObj = currentWords[currentIndex];
    const isCorrect = selected === correct;

    // ËÆ∞ÂΩïÁ¨¨‰∏ÄÊ¨°ÂõûÁ≠î
    if (!wordObj.answered) {
        wordObj.answered = true;
        wordObj.correct = isCorrect;
    }

    if (isCorrect) {
        clearInterval(timer);
        document.getElementById("result").innerHTML = "‚úÖ ÂõûÁ≠îÊ≠£Á°ÆÔºÅ";
        document.getElementById("nextBtn").disabled = false;
    } else {
        document.querySelectorAll('.option').forEach(opt => {
            opt.classList.add('error-shake');
            setTimeout(() => opt.classList.remove('error-shake'), 400);
        });
        document.getElementById("result").innerHTML = "‚ùå ÂõûÁ≠îÈîôËØØÔºåËØ∑ÈáçËØïÔºÅ";
    }
}

function nextQuestion() {
    currentIndex++;
    document.getElementById("nextBtn").disabled = true;
    document.getElementById("result").innerHTML = "";
    
    if(currentIndex < currentWords.length) {
        showQuestion();
    } else {
        showFinalResult();
    }
}

function showFinalResult() {
    const correctCount = currentWords.filter(word => word.correct).length;
    const accuracy = Math.round((correctCount / currentWords.length) * 100);
    
    document.getElementById("practicePanel").innerHTML = `
        <div class="congrats">üéä ÊÅ≠ÂñúÂÆåÊàêÊâÄÊúâÁªÉ‰π†ÔºÅ</div>
        <div class="score">
            Ê≠£Á°ÆÁéáÔºö${correctCount}/${currentWords.length} (${accuracy}%)<br>
            Accuracy: ${correctCount}/${currentWords.length} (${accuracy}%)
        </div>
        <button class="lesson-btn" onclick="backToLessons()" 
            style="margin-top:40px; width:300px;">
            üêª ËøîÂõûËØæÁ®ãÈÄâÊã©
        </button>
    `;
}

function backToLessons() {
    document.getElementById("lessonGrid").style.display = "grid";
    document.getElementById("practicePanel").style.display = "none";
    document.getElementById("practicePanel").innerHTML = `
        <button id="backBtn">üêæ ËøîÂõûËØæÁ®ã</button>
        <div class="timer" id="timer">10</div>
        <div class="options" id="options"></div>
        <div id="result"></div>
        <button id="nextBtn" disabled>üéâ ‰∏ã‰∏ÄÈ¢ò</button>
    `;
    document.getElementById("backBtn").onclick = backToLessons;
    document.getElementById("nextBtn").onclick = nextQuestion;
    clearInterval(timer);
}

function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function generateOptions(correctWordObj) {
    const options = new Set([correctWordObj]);
    while (options.size < 4) {
        const randomWord = currentWords[Math.floor(Math.random() * currentWords.length)];
        options.add(randomWord);
    }
    return shuffleArray(Array.from(options));
}

function handleTimeout() {
    clearInterval(timer);
    document.getElementById("result").innerHTML = "‚è∞ Êó∂Èó¥Âà∞ÔºÅ";
}

// ÂàùÂßãÂåñÁ≥ªÁªü
initLessons();
synth.onvoiceschanged = initVoices;

// ‰∫ã‰ª∂ÁªëÂÆö
document.getElementById("backBtn").onclick = backToLessons;
document.getElementById("nextBtn").onclick = nextQuestion;
</script>
</body>
</html>