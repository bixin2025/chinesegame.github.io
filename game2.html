<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YCT1 è¶£å‘³å¬åŠ›ç»ƒä¹ </title>
    <style>
        body {
            background-color: #f5f5dc;
            font-family: KaiTi, serif;
            text-align: center;
            padding: 20px;
        }
        .main-title {
            font-size: 48px;
            margin: 30px 0;
        }
        .title-pinyin {
            font-family: "Comic Sans MS", cursive;
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        .lesson-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            max-width: 800px;
            margin: 40px auto;
        }
        .lesson-btn {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            font-size: 24px;
        }
        .lesson-btn:hover {
            transform: scale(1.05) rotate(2deg);
        }
        #practicePanel {
            position: relative;
        }
        #backBtn {
            position: absolute;
            left: 20px;
            top: 20px;
            padding: 12px 24px;
            border-radius: 20px;
            background: #FFB6C1;
            border: 2px solid white;
            font-size: 18px;
            color: #8B0000;
            cursor: pointer;
            transition: all 0.3s;
        }
        #backBtn:hover {
            background: #FF69B4;
            transform: scale(1.1);
        }
        .options {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        .option {
            background: linear-gradient(145deg, #87CEEB, #4682B4);
            color: white;
            padding: 20px;
            border-radius: 15px;
            cursor: pointer;
            width: 200px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .option:hover {
            transform: scale(1.05);
        }
        .pinyin {
            font-family: "Comic Sans MS", cursive;
            font-size: 28px;
            margin-bottom: 10px;
            color: #FFD700;
        }
        .chinese {
            font-size: 24px;
        }
        #nextBtn {
            font-size: 24px;
            padding: 15px 30px;
            margin: 20px;
            border-radius: 25px;
            background: linear-gradient(145deg, #FFA07A, #FF6347);
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        #nextBtn:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        .congrats {
            font-size: 48px;
            color: #4CAF50;
            margin: 40px 0;
        }
        .score {
            font-size: 36px;
            color: #2c3e50;
            margin: 20px 0;
        }
        .timer {
            font-size: 32px;
            margin: 20px 0;
            color: #2c3e50;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-8px); }
            100% { transform: translateX(0); }
        }
        .error-shake {
            animation: shake 0.4s ease-in-out;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-title">
        <div class="title-pinyin">TÄ«ng LÃ¬ LiÃ n XÃ­</div>
        å¬åŠ›ç»ƒä¹ 
    </div>
    <div class="lesson-grid" id="lessonGrid"></div>

    <div id="practicePanel" style="display:none;">
        <button id="backBtn">ğŸ¾ è¿”å›è¯¾ç¨‹</button>
        <div class="timer" id="timer">10</div>
        <div class="options" id="options"></div>
        <div id="result"></div>
        <button id="nextBtn" disabled>ğŸ‰ ä¸‹ä¸€é¢˜</button>
    </div>

<script>
// ================== å¯ä¿®æ”¹çš„æ‹¼éŸ³é…ç½® ==================
const pinyinMap = {
    "ä¸€":"yÄ«", "äºŒ":"Ã¨r", "ä¸‰":"sÄn", "å››":"sÃ¬", "äº”":"wÇ”",
    "å…­":"liÃ¹", "ä¸ƒ":"qÄ«", "å…«":"bÄ", "ä¹":"jiÇ”", "å":"shÃ­",
    "è€å¸ˆ":"lÇo shÄ«", "ä½ ":"nÇ", "å¥½":"hÇo", "å†è§":"zÃ i jiÃ n",
    "æˆ‘":"wÇ’", "å«":"jiÃ o", "ä»€ä¹ˆ":"shÃ©n me", "è®¤è¯†":"rÃ¨n shi",
    "å¾ˆ":"hÄ›n", "é«˜å…´":"gÄo xÃ¬ng", "å¥¹":"tÄ", "å—":"ma", "ä¸":"bÃ¹",
    "ä»–":"tÄ", "æ˜¯":"shÃ¬", "è°":"shÃ©i", "å“ª":"nÇ", "å›½":"guÃ³",
    "äºº":"rÃ©n", "ä¸­å›½äºº":"zhÅng guÃ³ rÃ©n", "çˆ¸çˆ¸":"bÃ  ba", "å¦ˆå¦ˆ":"mÄ ma",
    "å“¥å“¥":"gÄ“ ge", "å§å§":"jiÄ› jie", "å¼Ÿå¼Ÿ":"dÃ¬ di", "å¦¹å¦¹":"mÃ¨i mei",
    "å®¶":"jiÄ", "æœ‰":"yÇ’u", "å‡ ":"jÇ", "å£":"kÇ’u", "å’Œ":"hÃ©",
    "æ²¡æœ‰":"mÃ©i yÇ’u", "ä¸ª":"gÃ¨", "å²":"suÃ¬", "å¤šå¤§":"duÅ dÃ ",
    "ä¹Ÿ":"yÄ›", "å¤´å‘":"tÃ³u fa", "é¼»å­":"bÃ­ zi", "çœ¼ç›":"yÇn jing",
    "è€³æœµ":"Ä›r duo", "æ‰‹":"shÇ’u", "çš„":"de", "å°":"xiÇo", "å¤§":"dÃ ",
    "é•¿":"chÃ¡ng", "ä¸ªå­":"gÃ¨ zi", "çœŸ":"zhÄ“n", "é«˜":"gÄo", "çŒ«":"mÄo",
    "ç‹—":"gÇ’u", "é±¼":"yÃº", "é¸Ÿ":"niÇo", "è¿™":"zhÃ¨", "é‚£":"nÃ ",
    "çœ‹":"kÃ n", "è¿™å„¿":"zhÃ¨r", "å¤š":"duÅ", "é‚£å„¿":"nÃ r", "å­¦æ ¡":"xuÃ© xiÃ o",
    "å•†åº—":"shÄng diÃ n", "åœ¨":"zÃ i", "è°¢è°¢":"xiÃ¨ xie", "å»":"qÃ¹",
    "ä½ ä»¬":"nÇ men", "æˆ‘ä»¬":"wÇ’ men", "å“ªå„¿":"nÇr", "ç”Ÿæ—¥":"shÄ“ng rÃ¬",
    "æœˆ":"yuÃ¨", "å·":"hÃ o", "ä»Šå¤©":"jÄ«n tiÄn", "æ˜å¤©":"mÃ­ng tiÄn",
    "æ˜ŸæœŸ":"xÄ«ng qÄ«", "å–œæ¬¢":"xÇ huan", "æ˜ŸæœŸä¸€":"xÄ«ng qÄ« yÄ«",
    "æ˜ŸæœŸäºŒ":"xÄ«ng qÄ« Ã¨r", "æ˜ŸæœŸä¸‰":"xÄ«ng qÄ« sÄn", "æ˜ŸæœŸå››":"xÄ«ng qÄ« sÃ¬",
    "æ˜ŸæœŸäº”":"xÄ«ng qÄ« wÇ”", "æ˜ŸæœŸå…­":"xÄ«ng qÄ« liÃ¹", "æ˜ŸæœŸå¤©":"xÄ«ng qÄ« tiÄn",
    "ç°åœ¨":"xiÃ n zÃ i", "ç‚¹":"diÇn", "åˆ†":"fÄ“n", "è§":"jiÃ n",
    "æ—©ä¸Š":"zÇo shang", "å¤ªæ—©äº†":"tÃ i zÇo le", "åƒ":"chÄ«", "å–":"hÄ“",
    "çˆ±":"Ã i", "è›‹ç³•":"dÃ n gÄo", "ç±³é¥­":"mÇ fÃ n", "é¢æ¡":"miÃ n tiÃ¡o",
    "è‹¹æœ":"pÃ­ng guÇ’", "ç‰›å¥¶":"niÃº nÇi", "æ°´":"shuÇ"
};

// ================== è¯¾ç¨‹æ•°æ® ==================
const lessonData = {
    "1": ["ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­", "ä¸ƒ", "å…«", "ä¹", "å", "è€å¸ˆ", "ä½ ", "å¥½", "å†è§"],
    "2": ["æˆ‘", "å«", "ä»€ä¹ˆ", "è®¤è¯†", "å¾ˆ", "é«˜å…´", "å¥¹", "å—", "ä¸"],
    "3": ["ä»–", "æ˜¯", "è°", "å“ª", "å›½", "äºº", "ä¸­å›½äºº"],
    "4": ["çˆ¸çˆ¸", "å¦ˆå¦ˆ", "å“¥å“¥", "å§å§", "å¼Ÿå¼Ÿ", "å¦¹å¦¹", "å®¶", "æœ‰", "å‡ ", "å£", "å’Œ", "æ²¡æœ‰", "ä¸ª"],
    "5": ["å²", "å¤šå¤§", "ä¹Ÿ", "çˆ¸çˆ¸", "å¦ˆå¦ˆ", "å“¥å“¥", "å§å§", "å¼Ÿå¼Ÿ", "å¦¹å¦¹"],
    "6": ["å¤´å‘", "é¼»å­", "çœ¼ç›", "è€³æœµ", "æ‰‹", "çš„", "å°", "å¤§", "é•¿", "ä¸ªå­", "çœŸ", "é«˜"],
    "7": ["çŒ«", "ç‹—", "é±¼", "é¸Ÿ", "è¿™", "é‚£", "çœ‹", "è¿™å„¿", "å¤š", "é‚£å„¿"],
    "8": ["å­¦æ ¡", "å•†åº—", "åœ¨", "è°¢è°¢", "å»", "ä½ ä»¬", "æˆ‘ä»¬", "å“ªå„¿"],
    "9": ["ç”Ÿæ—¥", "æœˆ", "å·", "ä»Šå¤©", "æ˜å¤©", "æ˜ŸæœŸ", "å–œæ¬¢", "æ˜ŸæœŸä¸€", "æ˜ŸæœŸäºŒ", "æ˜ŸæœŸä¸‰", "æ˜ŸæœŸå››", "æ˜ŸæœŸäº”", "æ˜ŸæœŸå…­", "æ˜ŸæœŸå¤©"],
    "10": ["ç°åœ¨", "ç‚¹", "åˆ†", "è§", "æ—©ä¸Š", "å¤ªæ—©äº†"],
    "11": ["åƒ", "å–", "çˆ±", "è›‹ç³•", "ç±³é¥­", "é¢æ¡", "è‹¹æœ", "ç‰›å¥¶", "æ°´"],
    "12": []
};

// ================== ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘ ==================
let currentLesson = "";
let currentWords = [];
let currentIndex = 0;
let timer;
let synth = window.speechSynthesis;
let chineseVoice;

function initVoices() {
    const voices = synth.getVoices();
    chineseVoice = voices.find(voice => 
        voice.lang === 'zh-CN' && voice.name.includes('Xiaoxiao')
    ) || voices.find(voice => 
        voice.lang.startsWith('zh')
    );
}

function initLessons() {
    const grid = document.getElementById("lessonGrid");
    grid.innerHTML = Array.from({length:12}, (_,i) => {
        const lessonNumber = i + 1;
        return `<div class="lesson-btn" onclick="startPractice('${lessonNumber}')">Lesson${lessonNumber}</div>`;
    }).join("");
}

function startPractice(lessonId) {
    currentLesson = lessonId;
    currentIndex = 0;
    
    if (lessonId === "12") {
        const allWords = [];
        for (let i = 1; i <= 11; i++) {
            allWords.push(...lessonData[i.toString()]);
        }
        currentWords = shuffleArray(allWords).slice(0, 10);
    } else {
        currentWords = [...lessonData[lessonId]];
    }

    currentWords = currentWords.map(word => ({
        word: word,
        pinyin: pinyinMap[word] || word,
        correct: false,
        answered: false
    }));

    document.getElementById("lessonGrid").style.display = "none";
    document.getElementById("practicePanel").style.display = "block";
    showQuestion();
}

function showQuestion() {
    const wordObj = currentWords[currentIndex];
    const options = generateOptions(wordObj);
    
    document.getElementById("options").innerHTML = options.map(w => `
        <div class="option" onclick="checkAnswer('${w.word}', '${wordObj.word}')">
            <div class="pinyin">${w.pinyin}</div>
            <div class="chinese">${w.word}</div>
        </div>
    `).join("");

    playAudio(wordObj.word);
    startTimer();
}

function playAudio(word) {
    if (synth.speaking) synth.cancel();
    
    const utterance = new SpeechSynthesisUtterance(word);
    utterance.lang = 'zh-CN';
    utterance.rate = 0.8;
    utterance.pitch = 1;
    if (chineseVoice) utterance.voice = chineseVoice;

    synth.speak(utterance);
    setTimeout(() => {
        const utterance2 = new SpeechSynthesisUtterance(word);
        utterance2.lang = 'zh-CN';
        utterance2.rate = 0.8;
        utterance2.pitch = 1;
        if (chineseVoice) utterance2.voice = chineseVoice;
        synth.speak(utterance2);
    }, 800);
}

function startTimer() {
    let time = 10;
    const timerElement = document.getElementById("timer");
    clearInterval(timer);
    timer = setInterval(() => {
        time--;
        timerElement.textContent = time;
        if (time <= 0) handleTimeout();
    }, 1000);
}

function checkAnswer(selected, correct) {
    const wordObj = currentWords[currentIndex];
    const isCorrect = selected === correct;

    // è®°å½•ç¬¬ä¸€æ¬¡å›ç­”
    if (!wordObj.answered) {
        wordObj.answered = true;
        wordObj.correct = isCorrect;
    }

    if (isCorrect) {
        clearInterval(timer);
        document.getElementById("result").innerHTML = "âœ… å›ç­”æ­£ç¡®ï¼";
        document.getElementById("nextBtn").disabled = false;
    } else {
        document.querySelectorAll('.option').forEach(opt => {
            opt.classList.add('error-shake');
            setTimeout(() => opt.classList.remove('error-shake'), 400);
        });
        document.getElementById("result").innerHTML = "âŒ å›ç­”é”™è¯¯ï¼Œè¯·é‡è¯•ï¼";
    }
}

function nextQuestion() {
    currentIndex++;
    document.getElementById("nextBtn").disabled = true;
    document.getElementById("result").innerHTML = "";
    
    if(currentIndex < currentWords.length) {
        showQuestion();
    } else {
        showFinalResult();
    }
}

function showFinalResult() {
    const correctCount = currentWords.filter(word => word.correct).length;
    const accuracy = Math.round((correctCount / currentWords.length) * 100);
    
    document.getElementById("practicePanel").innerHTML = `
        <div class="congrats">ğŸŠ æ­å–œå®Œæˆæ‰€æœ‰ç»ƒä¹ ï¼</div>
        <div class="score">
            æ­£ç¡®ç‡ï¼š${correctCount}/${currentWords.length} (${accuracy}%)<br>
            Accuracy: ${correctCount}/${currentWords.length} (${accuracy}%)
        </div>
        <button class="lesson-btn" onclick="backToLessons()" 
            style="margin-top:40px; width:300px;">
            ğŸ» è¿”å›è¯¾ç¨‹é€‰æ‹©
        </button>
    `;
}

function backToLessons() {
    document.getElementById("lessonGrid").style.display = "grid";
    document.getElementById("practicePanel").style.display = "none";
    document.getElementById("practicePanel").innerHTML = `
        <button id="backBtn">ğŸ¾ è¿”å›è¯¾ç¨‹</button>
        <div class="timer" id="timer">10</div>
        <div class="options" id="options"></div>
        <div id="result"></div>
        <button id="nextBtn" disabled>ğŸ‰ ä¸‹ä¸€é¢˜</button>
    `;
    document.getElementById("backBtn").onclick = backToLessons;
    document.getElementById("nextBtn").onclick = nextQuestion;
    clearInterval(timer);
}

function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}

function generateOptions(correctWordObj) {
    const options = new Set([correctWordObj]);
    while (options.size < 4) {
        const randomWord = currentWords[Math.floor(Math.random() * currentWords.length)];
        options.add(randomWord);
    }
    return shuffleArray(Array.from(options));
}

function handleTimeout() {
    clearInterval(timer);
    document.getElementById("result").innerHTML = "â° æ—¶é—´åˆ°ï¼";
}

// åˆå§‹åŒ–ç³»ç»Ÿ
initLessons();
synth.onvoiceschanged = initVoices;

// äº‹ä»¶ç»‘å®š
document.getElementById("backBtn").onclick = backToLessons;
document.getElementById("nextBtn").onclick = nextQuestion;
</script>
</body>
</html>